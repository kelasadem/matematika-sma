<!doctype html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kelas Adem: Uji Kompetensi Turunan</title>
  <!-- <script src="/_sdk/data_sdk.js"></script> -->
  <!-- <script src="/_sdk/element_sdk.js"></script> -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      }
    };
  </script>
  <style>
    body {
      box-sizing: border-box;
    }

    .question-card {
      transition: all 0.3s ease;
    }

    .timer-warning {
      animation: pulse 1s infinite;
    }

    .d-none {
      display: none;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.7;
      }
    }

    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
  <style>
    @view-transition {
      navigation: auto;
    }
  </style>
</head>

<body class="min-h-full bg-gradient-to-br from-blue-50 to-indigo-100">

  <main class="container mx-auto px-4 py-8">

    <!-- Login Screen -->
    <div id="loginScreen" class="max-w-md mx-auto bg-white rounded-xl shadow-lg p-8 fade-in">
      <div class="text-center mb-8">

        <img class="h-auto max-w-lg mx-auto"
          src="https://upload.wikimedia.org/wikipedia/id/thumb/d/d9/Logo_SMA_Negeri_1_Majalengka.png/250px-Logo_SMA_Negeri_1_Majalengka.png"
          width="64px" alt="image description">
        <h1 id="schoolName" class="text-lg text-gray-900">SMA Negeri 1 Majalengka</h1>
        <hr class="mb-4">
        <!-- <p class="text-gray-600">Kelas Adem</p> -->

        <h2 id="examTitle" class="text-base font-medium text-gray-700">
          Uji Kompetensi Matematika</span> <br>
          Turunan
        </h2>
        <p class="text-xs text-gray-900">(Jumlah Soal 10 Nomor - Waktu 20 Menit)</p>

        <div style="display: grid; font-size: 8pt; grid-template-columns: 49% 2% 49%;">
        </div>
      </div>

      <form id="loginForm" class="space-y-6">
        <div>
          <label for="studentName" class="block text-sm font-medium text-gray-700 mb-2">Nama Lengkap</label>
          <input type="text" id="studentName" required
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
        </div>
        <div>
          <label for="studentClass" class="block text-sm font-medium text-gray-700 mb-2">Kelas</label>
          <select id="studentClass" required
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            <option value="">Pilih Kelas</option>
            <option value="XII.2">XII.2</option>
            <option value="XII.3">XII.3</option>
            <option value="XII.6">XII.6</option>
            <option value="XII.7">XII.7</option>
            <option value="XII.10">XII.10</option>
            <option value="XII.11">XII.11</option>
            <option value="Lainnya">Kelas Lainnya</option>
          </select>
        </div>
        <div>
          <label for="username" class="block text-sm font-medium text-gray-700 mb-2">Username</label>
          <input type="text" id="username" required
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
        </div>
        <div>
          <label for="password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
          <input type="password" id="password" required
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
        </div>
        <div style="display: none;">
          <label for="difficulty" class="block text-sm font-medium text-gray-700 mb-2">Jenis Ujian</label>
          <select id="difficulty" required
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            <option value="campuran">Ujian Campuran (10 soal: 3 mudah, 5 sedang, 2 sulit)</option>
          </select>
        </div>
        <!-- type="submit" id="loginBtn" -->
        <button
          class="mt-4 w-full bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors font-medium">
          Mulai
          Ujian </button>
      </form>
    </div>

    <!-- Exam Screen -->
    <div id="examScreen" class="hidden">

      <!-- Header -->
      <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
        <div class="flex justify-between items-center">
          <div>
            <h2 class="text-base  text-gray-800">Turunan</h2>
            <p class="text-gray-600"><span id="currentStudent"></span></p>
          </div>
          <div class="text-right">
            <div id="timer" class="text-2xl font-bold text-blue-600 mb-1">
              20:00
            </div>
            <div class="text-sm text-gray-600">
              Waktu Tersisa
            </div>
          </div>
        </div>
        <div class="mt-4">
          <div class="flex justify-between text-sm text-gray-600 mb-2"><span>Soal <span id="currentQuestionNum">1</span>
              dari
              <span id="totalQuestions">10</span></span>
            <span class="d-none">Tingkat Kesukaran: <span id="currentDifficulty" class="font-medium"></span></span>
          </div>
          <div class="w-full bg-gray-200 rounded-full h-2">
            <div id="progressBar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 10%">
            </div>
          </div>
        </div>
      </div>

      <!-- Question Card -->
      <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
        <div id="questionContent" class="mb-6">
          <!-- Question will be loaded here -->
        </div>
        <div id="optionsContainer" class="space-y-3">
          <!-- Options will be loaded here -->
        </div>
      </div>

      <!-- Navigation -->
      <div class="flex justify-between">
        <button id="prevBtn"
          class="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
          &lt; Sebelumnya
        </button>
        <button id="nextBtn" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
          Selanjutnya &gt;
        </button>
        <button id="finishBtn"
          class="hidden px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
          Selesai Ujian
        </button>
      </div>
    </div>

    <!-- Results Screen -->
    <div id="resultsScreen" class="hidden max-w-3xl mx-auto">

        <div class="bg-white rounded-xl shadow-lg p-8">

          <form id="loginForm" name="submit-to-google-sheet">

            <div id="lihat-hasil" class="hidden">

            <!-- Materi -->
            <input type="text" name="materi" value="Turunan" style="display: none;">

            <!-- Jenis Asesmen -->
            <input type="text" name="asesmen" value="Formatif" style="display: none;">
            <!-- - Assessment of Learning (penilaian hasil/akhir): Dilakukan setelah proses pembelajaran selesai untuk mengukur pencapaian belajar siswa dan sebagai dasar untuk penentuan nilai atau kenaikan kelas.
- Assessment for Learning (penilaian untuk belajar): Dilakukan selama proses pembelajaran untuk memberikan umpan balik agar guru dapat memperbaiki metode pengajaran dan siswa dapat meningkatkan performa.
- Assessment as Learning (penilaian sebagai belajar): Dilakukan selama proses pembelajaran dan melibatkan siswa secara aktif untuk mengembangkan kemampuan evaluasi diri, di mana siswa menjadi penilai bagi diri sendiri maupun temannya. -->

            <!-- Level -->
            <input type="text" name="level" value="Campuran" style="display: none;">

            <!-- Header with Icon and Title -->
            <div class="text-center mb-8">
              <div id="resultIcon"
                class="w-20 h-20 bg-white-500 rounded-full flex items-center justify-center mx-auto mb-4">
                <!-- <span class="text-white text-3xl">‚úì</span> -->
                <svg width="800px" height="800px" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M23 2H9C7.34315 2 6 3.34315 6 5V27C6 28.6569 7.34315 30 9 30H23C24.6569 30 26 28.6569 26 27V5C26 3.34315 24.6569 2 23 2Z"
                    fill="#FF8F00" />
                  <path
                    d="M20 22H12C11.7348 22 11.4804 21.8946 11.2929 21.7071C11.1054 21.5196 11 21.2652 11 21C11 20.7348 11.1054 20.4804 11.2929 20.2929C11.4804 20.1054 11.7348 20 12 20H20C20.2652 20 20.5196 20.1054 20.7071 20.2929C20.8946 20.4804 21 20.7348 21 21C21 21.2652 20.8946 21.5196 20.7071 21.7071C20.5196 21.8946 20.2652 22 20 22Z"
                    fill="#E0E0E0" />
                  <path
                    d="M18 25H14C13.7348 25 13.4804 24.8946 13.2929 24.7071C13.1054 24.5196 13 24.2652 13 24C13 23.7348 13.1054 23.4804 13.2929 23.2929C13.4804 23.1054 13.7348 23 14 23H18C18.2652 23 18.5196 23.1054 18.7071 23.2929C18.8946 23.4804 19 23.7348 19 24C19 24.2652 18.8946 24.5196 18.7071 24.7071C18.5196 24.8946 18.2652 25 18 25Z"
                    fill="#E0E0E0" />
                  <path
                    d="M22 10.81C21.9695 10.6231 21.8866 10.4487 21.761 10.3071C21.6353 10.1655 21.472 10.0625 21.29 10.01L18.2 9.13003L16.87 6.55003C16.7852 6.38878 16.6579 6.25377 16.5019 6.15959C16.346 6.06541 16.1672 6.01562 15.985 6.01562C15.8028 6.01562 15.6241 6.06541 15.4681 6.15959C15.3121 6.25377 15.1848 6.38878 15.1 6.55003L13.75 9.13003L10.75 10.02C10.5694 10.0717 10.407 10.1733 10.2814 10.313C10.1559 10.4527 10.0722 10.625 10.04 10.81C10.0043 10.9975 10.023 11.1913 10.0939 11.3685C10.1648 11.5457 10.2849 11.6989 10.44 11.81L12.44 13.23L12 15.82C11.9643 16.0075 11.983 16.2013 12.0539 16.3785C12.1248 16.5557 12.2449 16.7089 12.4 16.82C12.5756 16.9427 12.7859 17.0058 13 17C13.1589 17.0016 13.3161 16.9674 13.46 16.9L16 15.58L18.55 16.85C18.7098 16.9245 18.8865 16.9554 19.0621 16.9396C19.2377 16.9238 19.4061 16.8619 19.55 16.76C19.7052 16.6489 19.8253 16.4957 19.8961 16.3185C19.967 16.1413 19.9857 15.9475 19.95 15.76L19.54 13.17L21.54 11.76C21.6976 11.6603 21.8243 11.5185 21.9056 11.3507C21.9868 11.1828 22.0196 10.9955 22 10.81Z"
                    fill="#283593" />
                  <path
                    d="M9 2C8.20435 2 7.44129 2.31607 6.87868 2.87868C6.31607 3.44129 6 4.20435 6 5V27C6 27.7956 6.31607 28.5587 6.87868 29.1213C7.44129 29.6839 8.20435 30 9 30H16V2H9Z"
                    fill="#FFA726" />
                  <path
                    d="M12 20C11.7348 20 11.4804 20.1054 11.2929 20.2929C11.1054 20.4804 11 20.7348 11 21C11 21.2652 11.1054 21.5196 11.2929 21.7071C11.4804 21.8946 11.7348 22 12 22H16V20H12Z"
                    fill="#FAFAFA" />
                  <path
                    d="M14 23C13.7348 23 13.4804 23.1054 13.2929 23.2929C13.1054 23.4804 13 23.7348 13 24C13 24.2652 13.1054 24.5196 13.2929 24.7071C13.4804 24.8946 13.7348 25 14 25H16V23H14Z"
                    fill="#FAFAFA" />
                  <path
                    d="M15.1 6.54998L13.75 9.12998L10.75 10.02C10.5694 10.0717 10.407 10.1732 10.2814 10.3129C10.1559 10.4526 10.0722 10.6249 10.04 10.81C10.0043 10.9975 10.023 11.1912 10.0939 11.3684C10.1648 11.5456 10.2849 11.6988 10.44 11.81L12.44 13.23L12 15.82C11.9643 16.0075 11.983 16.2012 12.0539 16.3784C12.1248 16.5556 12.2449 16.7088 12.4 16.82C12.5756 16.9427 12.7859 17.0058 13 17C13.1589 17.0015 13.3161 16.9674 13.46 16.9L16 15.58V6.05998C15.8197 6.05288 15.6409 6.09467 15.4825 6.18094C15.324 6.2672 15.1919 6.39472 15.1 6.54998Z"
                    fill="#3949AB" />
                </svg>
              </div>
              <h2 class="text-2xl font-bold text-gray-800 mb-2">Ujian Selesai!</h2>
              <div id="gradeDisplay" class="text-4xl font-bold text-green-600 mb-2">
                A <br>
                <span class="text-lg text-gray-600">Grade Anda</span>
              </div>
              <div class="text-lg text-gray-600">
              </div>
            </div>

            <!-- Student Identity -->
            <div id="identitas" class="bg-gray-50 rounded-lg p-6 mb-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">Identitas Siswa</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div><span class="text-sm text-gray-600">Nama Lengkap:</span><br>
                  <textarea id="resultStudentName" rows="1"
                    style="background-color: rgba(0,0,0,0); overflow: hidden; width: 100%"
                    class="font-medium text-gray-800" name="nama"></textarea>
                  <!-- <div id="resultStudentName" class="font-medium text-gray-800">
        -
       </div> -->
                </div>
                <div><span class="text-sm text-gray-600">Username:</span><br>
                  <textarea id="resultUsername" rows="1"
                    style="background-color: rgba(0,0,0,0); overflow: hidden; width: 100%"
                    class="font-medium text-gray-800" name="user"></textarea>
                  <!-- <div id="resultUsername" class="font-medium text-gray-800">
        -
       </div> -->
                </div>
                <div>
                  <span class="text-sm text-gray-600">Kelas:</span> <br>
                  <textarea id="resultStudentClass" rows="1"
                    style="background-color: rgba(0,0,0,0); overflow: hidden; width: 100%"
                    class="font-medium text-gray-800" name="kelas"></textarea>
                </div>
                <div>
                  <span class="text-sm text-gray-600">Waktu Selesai:</span> <br>
                  <div id="examDate" class="font-medium text-gray-800">
                    -
                  </div>
                  <div id="examTime" class="font-medium text-gray-800">
                    -
                  </div>
                </div>
              </div>
            </div>

            <!-- Results Grid -->
            <div id="hasil" class="grid grid-cols-2 gap-6 mb-6">
              <div class="bg-blue-50 p-4 rounded-lg">
                <div class="text-2xl font-bold text-blue-600" id="final--Score">
                  <textarea id="finalScore" rows="1"
                    style="background-color: rgba(0,0,0,0); overflow: hidden; width: 100%"
                    class="text-2xl font-bold text-blue-600" name="skor"></textarea>
                </div>
                <div class="text-sm text-gray-600">
                  Skor Akhir
                </div>
              </div>
              <div class="bg-green-50 p-4 rounded-lg">
                <div class="text-2xl font-bold text-green-600" id="correctCount">
                  0
                </div>
                <div class="text-sm text-gray-600">
                  Jawaban Benar
                </div>
              </div>
              <div class="bg-yellow-50 p-4 rounded-lg">
                <div class="text-2xl font-bold text-yellow-600" id="timeTaken">
                  0
                </div>
                <div class="text-sm text-gray-600">
                  Waktu Digunakan
                </div>
              </div>
              <div class="bg-purple-50 p-4 rounded-lg">
                <div class="text-2xl font-bold text-purple-600" id="difficultyLevel">
                  -
                </div>
                <div class="text-sm text-gray-600">
                  Tingkat Kesukaran
                </div>
              </div>
            </div>
            
            <!-- Motivational Comment -->
            <div id="motivationalComment" class="bg-gradient-to-r from-blue-50 to-indigo-50 border-l-4 border-blue-500 p-6 mb-6 rounded-r-lg">
              <div class="flex items-start">
                <div class="text-2xl mr-3">
                  üí™
                </div>
                <div>
                  <h4 class="font-semibold text-gray-800 mb-2">Pesan Motivasi</h4>
                  <p id="motivationText" class="text-gray-700 leading-relaxed">Hasil yang luar biasa! Terus pertahankan
                    semangat
                    belajar Anda!</p>
                </div>
              </div>
            </div>

          </div>
          

          
            <div id="lihatNilai" class="text-sm text-gray-600 mb-6">
              <!-- Submit Button -->
              <div class="kumpulkan text-center">
                <button type="submit" id="submitBtn" class="btn-kirim">
                  <span id="submitText" class="text-2xl">üîç Lihat Nilai</span>
                </button>

                <div id="submitLoading" class="text-center btn-loading d-none">
                  <div role="status">
                    <svg aria-hidden="true"
                      class="inline w-8 h-8 text-gray-200 animate-spin dark:text-gray-600 fill-blue-600"
                      viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
                        fill="currentColor" />
                      <path
                        d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
                        fill="currentFill" />
                    </svg>
                    <span class="sr-only">Loading...</span>
                  </div>
                </div>

              </div>
              <div class="myAlert d-none text-center"><strong>Terimakasih!</strong> Hasil uji kompetensi Ananda sudah
                kami terima.</div>
            </div>
          
          </form>

          <div id="ujianbaru" class="hidden text-sm text-gray-600 mb-6">
            <div class="text-center">
              <button id="restartBtn"
                class="px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"> Ujian Baru
              </button>
            </div>
          </div>

        </div>
      </div>
    </div>

  </main>


  <!-- from https://github.com/jamiewilson/form-to-google-sheets -->
  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyUj1PysG7mPIcfZXGKrBJB7RzfX-PYqNYjPHkL4OxR8Os6ibRH-C-yyqQuByRqEmRu/exec'
    const form = document.forms['submit-to-google-sheet']

    const btnKirim = document.querySelector('.btn-kirim');
    const btnLoading = document.querySelector('.btn-loading');
    const myAlert = document.querySelector('.myAlert');
    const lihatHasil = document.querySelector('#lihat-hasil');
    const ujianBaru = document.querySelector('#ujianbaru');

    form.addEventListener('submit', e => {
      e.preventDefault()
      // Ketika tombol submit diklik
      // tampilkan tombol loading, hilangkan tombol kirim
      btnLoading.classList.toggle('d-none');
      btnKirim.classList.toggle('hidden');
      fetch(scriptURL, { method: 'POST', body: new FormData(form) })
        .then(response => {
          // tampilkan tombol kirim, hilangkan tombol loading
          btnLoading.classList.toggle('d-none');
          // btnKirim.classList.toggle('d-none');
          // tampilkan alert
          myAlert.classList.toggle('d-none');
          // tampilkan lihatHasil
          lihatHasil.classList.toggle('hidden');
          // tampilkan ujianBaru
          ujianBaru.classList.toggle('hidden');
          // reset-formnya
          form.reset();
          console.log('Success!', response);
        })
        .catch(error => console.error('Error!', error.message))
    })
  </script>


  <script>
    // Configuration
    const defaultConfig = {
      exam_title: "Uji Kompetensi Matematika",
      school_name: "SMA Negeri 1 Majalengka",
      time_limit: "20"
    };

    // Question Bank
    const questionBank = {
      mudah: [
        {
          id: 101,
          levelSoal: "‚≠ê",
          question: "Jika $h(x) = 7x^2$, maka $h'(x) = ...$",
          options: [
            "$14x$",
            "$7x$",
            "$7$",
            "$14$",
            "$14x^2$"
          ],
          correct: 0
        },
        {
          id: 102,
          levelSoal: "‚≠ê",
          question: "Turunan dari $y = x^5$ adalah ....",
          options: [
            "$5x^4$",
            "$x^4$",
            "$5x$",
            "$5$",
            "$x^5$"
          ],
          correct: 0
        },
        {
          id: 103,
          levelSoal: "‚≠ê",
          question: "Turunan dari konstanta $c$ adalah ....",
          options: [
            "$0$",
            "$c$",
            "$1$",
            "$c-1$",
            "$cx$"
          ],
          correct: 0
        },
        {
          id: 104,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = x^3$, maka $f'(x) = ...$",
          options: [
            "$3x^2$",
            "$x^2$",
            "$3x$",
            "$3$",
            "$x^3$"
          ],
          correct: 0
        },
        {
          id: 105,
          levelSoal: "‚≠ê",
          question: "Turunan dari $y = 5x^4$ adalah ....",
          options: [
            "$20x^3$",
            "$5x^3$",
            "$4x^3$",
            "$20x^4$",
            "$20x$"
          ],
          correct: 0
        },
        {
          id: 106,
          levelSoal: "‚≠ê",
          question: "Turunan dari fungsi $f(x) = 3x^2 + 2x - 1$ adalah ....",
          options: [
            "$6x + 2$",
            "$3x + 2$",
            "$6x - 1$",
            "$3x^2 + 2$",
            "$3x^2 + 2x$"
          ],
          correct: 0
        },
        {
          id: 107,
          levelSoal: "‚≠ê",
          question: "Jika $g(x) = 2x + 3$, maka $g'(x) = ...$",
          options: [
            "$2$",
            "$3$",
            "$2x$",
            "$x^2 + 3x$",
            "$5$"
          ],
          correct: 0
        },
        {
          id: 108,
          levelSoal: "‚≠ê",
          question: "Turunan dari $f(x) = x^2 + 4x$ adalah ....",
          options: [
            "$2x + 4$",
            "$x + 4$",
            "$2x$",
            "$x^2 + 4$",
            "$6x$"
          ],
          correct: 0
        },
        {
          id: 109,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = 3x - 2$, maka $f'(x) = ...$",
          options: [
            "$3$",
            "$-2$",
            "$3x$",
            "$x$",
            "$1$"
          ],
          correct: 0
        },
        {
          id: 110,
          levelSoal: "‚≠ê",
          question: "Turunan dari $g(x) = x^2 - 5$ adalah ....",
          options: [
            "$2x$",
            "$x$",
            "$2x - 5$",
            "$x^2$",
            "$2$"
          ],
          correct: 0
        },
        {
          id: 111,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = x^2 \\sqrt{x}$, maka $f'(x) = $ ....",
          options: [
            "$2\\frac{1}{2} x \\sqrt{x}$",
            "$\\frac{1}{2} x \\sqrt{x}$",
            "$1\\frac{1}{2} x \\sqrt{x}$",
            "$1\\frac{1}{2} x^3 \\sqrt{x}$",
            "$2\\frac{1}{2} x^3 \\sqrt{x}$"
          ],
          correct: 0
        },
        {
          id: 112,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = -4x^{-2}$, maka $f'(x) = $ ....",
          options: [
            "$8x^{-3}$",
            "$4x^{-3}$",
            "$4x^{-2}$",
            "$4x^{-1}$",
            "$8x^{-1}$"
          ],
          correct: 0
        },
        {
          id: 113,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = \\dfrac{2}{x^2}$, maka $f'(x) = $ ....",
          options: [
            "$-4x^{-3}$",
            "$-2x^{-3}$",
            "$-2x^{-1}$",
            "$4x^{-3}$",
            "$2x^{-1}$"
          ],
          correct: 0
        },
        {
          id: 114,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = \\dfrac{3}{x}$, maka $f'(x) = $ ....",
          options: [
            "$-\\dfrac{3}{x^2}$",
            "0",
            "3",
            "$-3$",
            "$\\dfrac{3}{x^2}$"
          ],
          correct: 0
        },
        {
          id: 115,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = \\dfrac{4}{\\sqrt{x}}$, maka $f'(x) = $ ....",
          options: [
            "$-\\dfrac{2}{x\\sqrt{x}}$",
            "$2\\sqrt{x}$",
            "$-2\\sqrt{x}$",
            "$-8\\sqrt{x}$",
            "$-\\dfrac{8}{x\\sqrt{x}}$"
          ],
          correct: 0
        },
        {
          id: 116,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = x - \\dfrac{1}{x}$, maka $f'(x) = $ ....",
          options: [
            "$1+\\dfrac{1}{x^2}$",
            "$1-\\dfrac{1}{x^2}$",
            "0",
            "$1-x^2$",
            "$1+x^2$"
          ],
          correct: 0
        },
        {
          id: 117,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = \\sin{2x}$, maka $f'(x) = $ ....",
          options: [
            "$2\\cos{2x}$",
            "$2\\sin{2x}$",
            "$2\\sin{2x}\\cos{2x}$",
            "$-2\\cos{2x}$",
            "$-2\\sec{2x}$"
          ],
          correct: 0
        },
        {
          id: 118,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = \\cos{3x}$, maka $f'(x) = $ ....",
          options: [
            "$-3\\sin{3x}$",
            "$3\\sin{3x}$",
            "$3\\sin{3x}\\cos{3x}$",
            "$3\\sin{3x}$",
            "$-3\\sec{3x}$"
          ],
          correct: 0
        },
        {
          id: 119,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = \\sin{3x} + \\sin{2x}$, maka $f'(x) = $ ....",
          options: [
            "$3\\cos{3x} + 2\\cos{2x}$",
            "$\\cos{3x} + \\cos{2x}$",
            "$-3\\cos{3x} - 2\\cos{2x}$",
            "$2\\cos{3x} + 3\\cos{2}$",
            "$5\\cos{5x}$"
          ],
          correct: 0
        },
        {
          id: 120,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = \\tan{2x}$, maka $f'(x) = $ ....",
          options: [
            "$2\\sec^2{2x}$",
            "$2\\csc^2{2x}$",
            "$2\\tan^2{2x}$",
            "$-2\\sec^2{2x}$",
            "$-2\\csc^2{2x}$"
          ],
          correct: 0
        },
        {
          id: 121,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = \\cot{3x}$, maka $f'(x) = $ ....",
          options: [
            "$-3\\csc^2{3x}$",
            "$-3\\sec^2{3x}$",
            "$3\\sec^2{3x}$",
            "$3\\csc^2{3x}$",
            "$3\\tan^2{3x}$"
          ],
          correct: 0
        },
        {
          id: 122,
          levelSoal: "‚≠ê",
          question: "Jika $f(x) = \\sec{3x}$, maka $f'(x) = $ ....",
          options: [
            "$3\\tan{3x}\\sec{3x}$",
            "$-3\\tan{3x}\\sec{3x}$",
            "$-3\\cot{3x}\\csc{3x}$",
            "$3\\cot{3x}\\csc{3x}$",
            "$3\\sec{3x}\\csc{3x}$"
          ],
          correct: 0
        }
      ],
      sedang: [
        {
          id: 201,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $f(x) = (x^2 + 1)^4$, maka $f'(x) = ....$",
          options: [
            "$8x(x^2 + 1)^3$",
            "$4(x^2 + 1)^3$",
            "$4x(x^2 + 1)^3$",
            "$8(x^2 + 1)^3$",
            "$4x^2(x^2 + 1)^3$"
          ],
          correct: 0
        },
        {
          id: 202,
          levelSoal: "‚≠ê‚≠ê",
          question: "Turunan dari $f(x) = (2x + 1)^3$ adalah ....",
          options: [
            "$6(2x + 1)^2$",
            "$3(2x + 1)^2$",
            "$6(2x + 1)$",
            "$3x(2x + 1)^2$",
            "$6x(2x + 1)^2$"
          ],
          correct: 0
        },
        {
          id: 203,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $f(x) = \\frac{x^2}{x+1}$, maka $f'(x) = ....$",
          options: [
            "$\\frac{x^2 + 2x}{(x+1)^2}$",
            "$\\frac{2x}{x+1}$",
            "$\\frac{x^2}{(x+1)^2}$",
            "$\\frac{x^2 + 2x}{x+1}$",
            "$\\frac{x + 2}{x+1}$"
          ],
          correct: 0
        },
        {
          id: 204,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $h(x) = \\sqrt{x^2 + 4}$, maka $h'(x) = ....$",
          options: [
            "$\\frac{x}{\\sqrt{x^2 + 4}}$",
            "$\\frac{2x}{\\sqrt{x^2 + 4}}$",
            "$\\frac{1}{\\sqrt{x^2 + 4}}$",
            "$\\frac{1x+1}{\\sqrt{x^2 + 4}}$",
            "$\\frac{2x+2}{\\sqrt{x^2 + 4}}$"
          ],
          correct: 0
        },
        {
          id: 205,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $f(x) = \\frac{1}{x^2 + 1}$, maka $f'(x) = ....$",
          options: [
            "$-\\frac{2x}{(x^2 + 1)^2}$",
            "$\\frac{2x}{(x^2 + 1)^2}$",
            "$-\\frac{1}{(x^2 + 1)^2}$",
            "$-\\frac{2x}{x^2 + 1}$",
            "$-\\frac{x}{x^2 + 1}^2$"
          ],
          correct: 0
        },
        {
          id: 206,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $f(x) = (x+2)(x^2+2x+3)$, maka $f'(x) = ....$",
          options: [
            "$3x^2 + 8x + 7$",
            "$3x^2 - 2x + 7$",
            "$-x^2 - 4x - 7$",
            "$3x^2 + 8x + 5$",
            "$-x^2 - 4x - 1$"
          ],
          correct: 0
        },
        {
          id: 207,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $f(x) = (x^2+1)(x+1)(x-1)$, maka $f'(x) = ....$",
          options: [
            "$4x^3$",
            "$4x^2$",
            "$4x$",
            "4",
            "0"
          ],
          correct: 0
        },
        {
          id: 208,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $f(x) = \\dfrac{x}{x-1}$, maka $f'(x) = ....$",
          options: [
            "$-\\frac{1}{(x-1)^2}$",
            "$\\frac{1}{(x-1)^2}$",
            "$\\frac{2}{(x-1)^2}$",
            "$-\\frac{2}{(x-1)^2}$",
            "$\\frac{1}{x-1}$"
          ],
          correct: 0
        },
        {
          id: 209,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $f(x) = (4x^2+5)^3$, maka $f'(x) = ....$",
          options: [
            "$24x(4x^2+5)^2$",
            "$3(4x^2+5)^2$",
            "$8x(4x^2+5)^2$",
            "$12x(4x^2+5)^2$",
            "$24x^2(4x^2+5)^2$"
          ],
          correct: 0
        },
        {
          id: 210,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $f(x) = \\tan^2{2x}$, maka $f'(x) = ....$",
          options: [
            "$4\\tan{2x}\\sec^2{2x}$",
            "$-4\\tan{2x}\\sec^2{2x}$",
            "$\\tan{2x}\\sec^2{2x}$",
            "$-2\\tan{2x}\\sec^2{2x}$",
            "$4\\tan{2x}\\sec{2x}$"
          ],
          correct: 0
        },
        {
          id: 211,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $f(x) = \\frac{1}{\\sin{2x}}$, maka $f'(x) = ....$",
          options: [
            "$-2\\cot{2x}\\csc{2x}$",
            "$2\\cot{2x}\\csc{2x}$",
            "$2\\tan{2x}\\sec{2x}$",
            "$-2\\tan{2x}\\sec{2x}$",
            "$2\\sec{2x}\\csc{2x}$"
          ],
          correct: 0
        },
        {
          id: 212,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $f(x) = 2\\cos^2{2x}$, maka $f'(x) = ....$",
          options: [
            "$-4\\sin{4x}$",
            "$-8\\sin{4x}$",
            "$-2\\sin{4x}$",
            "$4\\sin{4x}$",
            "$8\\sin{4x}$"
          ],
          correct: 0
        },
        {
          id: 213,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $f(x)=x^2-x-3$, maka gradien garis singgung di titik $x=-1$ adalah ....",
          options: [
            "-3",
            "-2",
            "-1",
            "1",
            "3"
          ],
          correct: 0
        },
        {
          id: 214,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $y=x^3-2x+3$, maka gradien garis singgung di titik $x=-1$ adalah ....",
          options: [
            "-5",
            "-3",
            "1",
            "3",
            "5"
          ],
          correct: 2
        },
        {
          id: 215,
          levelSoal: "‚≠ê‚≠ê",
          question: "Titik stasioner fungsi $f(x)=x^3-6x^2+9x+1$ terletak pada $x = $ ....",
          options: [
            "1 dan 3",
            "0 dan 3",
            "2 dan 3",
            "1 dan 2",
            "0 dan 1"
          ],
          correct: 0
        },
        {
          id: 216,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $s(t)=t^2+3t+1$ menyatakan posisi suatu benda bergerak, maka kecepatan sesaat pada $t=4$  adalah ....",
          options: [
            "11",
            "7",
            "8",
            "9",
            "10"
          ],
          correct: 0
        },
        {
          id: 217,
          levelSoal: "‚≠ê‚≠ê",
          question: "Gradien garis singgung terhadap kurva $y=\\dfrac{2}{x}$ di titik $x=-1$  adalah ....",
          options: [
            "$-2$",
            "2",
            "$-\\frac{1}{2}$",
            "$\\frac{1}{2}$",
            "1"
          ],
          correct: 0
        },
        {
          id: 218,
          levelSoal: "‚≠ê‚≠ê",
          question: "Jika $f(x)=\\sqrt{x+3}$, maka gradien singgung di $x=1$  adalah ....",
          options: [
            "$\\frac{1}{4}$",
            "$\\frac{1}{2}$",
            "$-\\frac{1}{2}$",
            "2",
            "$-\\frac{1}{4}$"
          ],
          correct: 0
        }
      ],
      sulit: [
        {
          id: 301,
          levelSoal: "‚≠ê‚≠ê‚≠ê",
          question: "Persamaan garis singgung kurva $y=x^2$ di titik $(2,4)$ adalah ....",
          options: [
            "$y=4x-4$",
            "$y=2x$",
            "$y=4x+4$",
            "$y=2x+2$",
            "$y=2x+4$"
          ],
          correct: 0
        },
        {
          id: 302,
          levelSoal: "‚≠ê‚≠ê‚≠ê",
          question: "Persamaan garis singgung kurva $y=3x^2 + 2x + 1$ di titik $(2,17)$ adalah ....",
          options: [
            "$y=14x-11$",
            "$y=14x+11$",
            "$y=14x-45$",
            "$y=14x-15$",
            "$y=14x+15$"
          ],
          correct: 0
        },
        {
          id: 303,
          levelSoal: "‚≠ê‚≠ê‚≠ê",
          question: "Grafik fungsi $y=x^3 - 3x^2 - 72x + 1$ monoton turun pada interval ....",
          options: [
            "$-4 < x < 6$",
            "$-6 < x < 4$",
            "$4 < x < 6$",
            "$x < -4$ atau $x > 6$",
            "$x < -6$ atau $x > 4$"
          ],
          correct: 0
        },
        {
          id: 304,
          levelSoal: "‚≠ê‚≠ê‚≠ê",
          question: "Grafik fungsi $y=\\frac{1}{3}x^3 - 3x^2 + 8x + 2$ monoton naik pada interval ....",
          options: [
            "$x < 2$ atau $x > 4$",
            "$2 < x < 4$",
            "$-4 < x < -2$",
            "$-2 < x < 4$",
            "$x < -4$ atau $x > -2$"
          ],
          correct: 0
        },
        {
          id: 305,
          levelSoal: "‚≠ê‚≠ê‚≠ê",
          question: "Pada interval $-1 < x < 4$, grafik fungsi $y=\\frac{1}{3}x^3 - x^2 - 3x + 1$ akan .... ",
          options: [
            "turun kemudian naik",
            "naik kemudian turun kemudian naik",
            "naik kemudian turun",
            "turun kemudian naik kemudian turun",
            "naik belok kemudian naik"
          ],
          correct: 0
        },
        {
          id: 306,
          levelSoal: "‚≠ê‚≠ê‚≠ê",
          question: "Pada interval $-3 < x < 4$, grafik fungsi $y=-\\frac{1}{3}x^3 + 2x^2 + 12x$ akan ....",
          options: [
            "turun kemudian naik",
            "naik kemudian turun kemudian naik",
            "naik kemudian turun",
            "turun kemudian naik kemudian turun",
            "naik belok kemudian naik"
          ],
          correct: 0
        },
        {
          id: 307,
          levelSoal: "‚≠ê‚≠ê‚≠ê",
          question: "Pada interval $0 \\le x \\le 4$, nilai minimum dari fungsi $f(x)=x^3 + 3x^2 - 45x$ adalah ....",
          options: [
            "$-81$",
            "$-100$",
            "$-135$",
            "$-68$",
            "$0$"
          ],
          correct: 0
        },
        {
          id: 308,
          levelSoal: "‚≠ê‚≠ê‚≠ê",
          question: "Pada interval $-3 \\le x \\le 3$, nilai maksimum dari fungsi $f(x) = x^3 - 3x^2 - 24x + 1$ adalah ....",
          options: [
            "$29$",
            "$19$",
            "$38$",
            "$73$",
            "$97$"
          ],
          correct: 0
        },
        {
          id: 309,
          levelSoal: "‚≠ê‚≠ê‚≠ê",
          question: "Untuk $y=x^3-3x^2+2$, titik pada $x=2$ adalah ....",
          options: [
            "titik balik minimum",
            "titik balik maksimum",
            "titik belok",
            "bukan titik stasioner",
            "titik pada interval fungsi turun"
          ],
          correct: 0
        }
      ]
    };

    // Valid credentials
    const validCredentials = [
      { username: "01", password: "siap" },
      { username: "02", password: "siap" },
      { username: "03", password: "siap" },
      { username: "04", password: "siap" },
      { username: "05", password: "siap" },
      { username: "06", password: "siap" },
      { username: "07", password: "siap" },
      { username: "08", password: "siap" },
      { username: "09", password: "siap" },
      { username: "10", password: "siap" },
      { username: "11", password: "siap" },
      { username: "12", password: "siap" },
      { username: "13", password: "siap" },
      { username: "14", password: "siap" },
      { username: "15", password: "siap" },
      { username: "16", password: "siap" },
      { username: "17", password: "siap" },
      { username: "18", password: "siap" },
      { username: "19", password: "siap" },
      { username: "20", password: "siap" },
      { username: "21", password: "siap" },
      { username: "22", password: "siap" },
      { username: "23", password: "siap" },
      { username: "24", password: "siap" },
      { username: "25", password: "siap" },
      { username: "26", password: "siap" },
      { username: "27", password: "siap" },
      { username: "28", password: "siap" },
      { username: "29", password: "siap" },
      { username: "30", password: "siap" },
      { username: "31", password: "siap" },
      { username: "32", password: "siap" },
      { username: "33", password: "siap" },
      { username: "34", password: "siap" },
      { username: "35", password: "siap" },
      { username: "36", password: "siap" },
      { username: "37", password: "siap" },
      { username: "38", password: "siap" },
      { username: "39", password: "siap" },
      { username: "40", password: "siap" },
      { username: "41", password: "siap" },
      { username: "42", password: "siap" },
      { username: "43", password: "siap" },
      { username: "44", password: "siap" },
      { username: "45", password: "siap" },
      { username: "46", password: "siap" },
      { username: "47", password: "siap" },
      { username: "48", password: "siap" },
      { username: "49", password: "siap" },
      { username: "50", password: "siap" },
      { username: "a", password: "aaa" }
    ];

    // Global variables
    let currentUser = null;
    let currentQuestions = [];
    let currentQuestionIndex = 0;
    let userAnswers = [];
    let startTime = null;
    let timerInterval = null;
    let timeLimit = 20; // minutes
    let examData = [];

    // Data handler for SDK
    const dataHandler = {
      onDataChanged(data) {
        examData = data;
        console.log('Exam data updated:', data.length, 'records');
      }
    };

    // Element SDK configuration
    const elementConfig = {
      defaultConfig: defaultConfig,
      onConfigChange: async (config) => {
        const examTitle = config.exam_title || defaultConfig.exam_title;
        const schoolName = config.school_name || defaultConfig.school_name;
        const timeLimitStr = config.time_limit || defaultConfig.time_limit;

        document.getElementById('examTitle').textContent = examTitle;
        document.getElementById('schoolName').textContent = schoolName;

        timeLimit = parseInt(timeLimitStr) || 60;
      },
      mapToCapabilities: (config) => ({
        recolorables: [],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      }),
      mapToEditPanelValues: (config) => new Map([
        ["exam_title", config.exam_title || defaultConfig.exam_title],
        ["school_name", config.school_name || defaultConfig.school_name],
        ["time_limit", config.time_limit || defaultConfig.time_limit]
      ])
    };

    // Initialize SDKs
    async function initializeApp() {
      try {
        if (window.dataSdk) {
          const initResult = await window.dataSdk.init(dataHandler);
          if (!initResult.isOk) {
            console.error('Failed to initialize data SDK');
          }
        }

        if (window.elementSdk) {
          await window.elementSdk.init(elementConfig);
        }
      } catch (error) {
        console.error('SDK initialization error:', error);
      }
    }

    // Login functionality
    document.getElementById('loginForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const studentName = document.getElementById('studentName').value.trim();
      const studentClass = document.getElementById('studentClass').value.trim();
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value;
      const difficulty = document.getElementById('difficulty').value;

      // Validate credentials
      const isValidUser = validCredentials.some(cred =>
        cred.username === username && cred.password === password
      );

      if (!isValidUser) {
        showMessage('Username atau password salah!', 'error');
        return;
      }

      if (!studentName || !difficulty) {
        showMessage('Mohon lengkapi semua field!', 'error');
        return;
      }

      // Set current user
      currentUser = {
        name: studentName,
        kelas: studentClass,
        username: username,
        difficulty: 'campuran'
      };

      // Start exam
      startExam();
    });

    function startExam() {
      // Hide login screen
      document.getElementById('loginScreen').classList.add('hidden');
      document.getElementById('examScreen').classList.remove('hidden');

      // Set up exam - create mixed question set (3 mudah, 5 sedang, 2 sulit)
      currentQuestions = [];

      // Get 3 random questions from mudah
      const mudahQuestions = [...questionBank.mudah];
      shuffleArray(mudahQuestions);
      currentQuestions.push(...mudahQuestions.slice(0, 3));

      // Get 5 random questions from sedang
      const sedangQuestions = [...questionBank.sedang];
      shuffleArray(sedangQuestions);
      currentQuestions.push(...sedangQuestions.slice(0, 5));

      // Get 2 random questions from sulit
      const sulitQuestions = [...questionBank.sulit];
      shuffleArray(sulitQuestions);
      currentQuestions.push(...sulitQuestions.slice(0, 2));

      // Shuffle the final mixed question set
      shuffleArray(currentQuestions);

      // Shuffle options for each question and track correct answer
      currentQuestions.forEach(question => {
        const correctOption = question.options[question.correct];
        const shuffledOptions = [...question.options];
        shuffleArray(shuffledOptions);

        question.options = shuffledOptions;
        question.correct = shuffledOptions.indexOf(correctOption);
      });

      currentQuestionIndex = 0;
      userAnswers = new Array(currentQuestions.length).fill(null);

      // Update UI
      document.getElementById('currentStudent').textContent = currentUser.name;
      document.getElementById('totalQuestions').textContent = currentQuestions.length;
      document.getElementById('currentDifficulty').textContent = 'CAMPURAN';

      // Start timer
      startTime = new Date();
      startTimer();

      // Load first question
      loadQuestion();
    }

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function loadQuestion() {
      const question = currentQuestions[currentQuestionIndex];

      // Update question number and progress
      document.getElementById('currentQuestionNum').textContent = currentQuestionIndex + 1;
      const progress = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
      document.getElementById('progressBar').style.width = progress + '%';

      // Load question content
      document.getElementById('questionContent').innerHTML = `
   <div class="flex items-center justify-between mb-4">
      <h3 class="text-lg font-semibold text-gray-800 mb-4">
       Soal ${currentQuestionIndex + 1}
      </h3>
						<span
							class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium">${question.levelSoal}</span>
					</div>
                <div class="text-gray-700 text-base leading-relaxed">
                    ${question.question}
                </div>
            `;

      // Load options
      const optionsContainer = document.getElementById('optionsContainer');
      optionsContainer.innerHTML = '';

      question.options.forEach((option, index) => {
        const optionDiv = document.createElement('div');
        optionDiv.className = 'option-item';
        optionDiv.innerHTML = `
                    <label class="flex items-center p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-blue-50 transition-colors">
                        <input type="radio" name="answer" value="${index}" class="mr-3 text-blue-600">
                        <span class="text-gray-700">${option}</span>
                    </label>
                `;
        optionsContainer.appendChild(optionDiv);
      });

      // Restore previous answer if exists
      if (userAnswers[currentQuestionIndex] !== null) {
        const radio = document.querySelector(`input[name="answer"][value="${userAnswers[currentQuestionIndex]}"]`);
        if (radio) radio.checked = true;
      }

      // Add event listeners to options
      document.querySelectorAll('input[name="answer"]').forEach(radio => {
        radio.addEventListener('change', function () {
          userAnswers[currentQuestionIndex] = parseInt(this.value);
        });
      });

      // Update navigation buttons
      document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;

      if (currentQuestionIndex === currentQuestions.length - 1) {
        document.getElementById('nextBtn').classList.add('hidden');
        document.getElementById('finishBtn').classList.remove('hidden');
      } else {
        document.getElementById('nextBtn').classList.remove('hidden');
        document.getElementById('finishBtn').classList.add('hidden');
      }

      // Re-render MathJax
      if (window.MathJax) {
        MathJax.typesetPromise([document.getElementById('questionContent'), optionsContainer]);
      }
    }

    // Navigation
    document.getElementById('prevBtn').addEventListener('click', function () {
      if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        loadQuestion();
      }
    });

    document.getElementById('nextBtn').addEventListener('click', function () {
      if (currentQuestionIndex < currentQuestions.length - 1) {
        currentQuestionIndex++;
        loadQuestion();
      }
    });

    document.getElementById('finishBtn').addEventListener('click', function () {
      finishExam();
    });

    // Timer functionality
    function startTimer() {
      const timerElement = document.getElementById('timer');

      timerInterval = setInterval(() => {
        const now = new Date();
        const elapsed = Math.floor((now - startTime) / 1000);
        const remaining = (timeLimit * 60) - elapsed;

        if (remaining <= 0) {
          clearInterval(timerInterval);
          finishExam();
          return;
        }

        const minutes = Math.floor(remaining / 60);
        const seconds = remaining % 60;
        timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

        // Warning when 5 minutes left
        if (remaining <= 300) {
          timerElement.classList.add('timer-warning', 'text-red-600');
        }
      }, 1000);
    }

    async function finishExam() {
      clearInterval(timerInterval);

      // Calculate results
      let correctAnswers = 0;
      currentQuestions.forEach((question, index) => {
        if (userAnswers[index] === question.correct) {
          correctAnswers++;
        }
      });

      const score = Math.round((correctAnswers / currentQuestions.length) * 100);
      const endTime = new Date();
      const timeTaken = Math.floor((endTime - startTime) / 1000);
      const timeTakenStr = `${Math.floor(timeTaken / 60)}:${(timeTaken % 60).toString().padStart(2, '0')}`;

      // Save to database
      if (window.dataSdk && examData.length < 999) {
        const examResult = {
          student_name: currentUser.name,
          username: currentUser.username,
          difficulty: currentUser.difficulty,
          score: score,
          total_questions: currentQuestions.length,
          correct_answers: correctAnswers,
          time_taken: timeTakenStr,
          answers: JSON.stringify(userAnswers),
          completed_at: new Date().toISOString()
        };

        const saveResult = await window.dataSdk.create(examResult);
        if (!saveResult.isOk) {
          console.error('Failed to save exam result');
        }
      } else if (examData.length >= 999) {
        showMessage('Batas maksimum 999 hasil ujian telah tercapai. Hasil tidak dapat disimpan.', 'warning');
      }

      // Show results
      showResults(score, correctAnswers, timeTakenStr);
    }

    function getGradeAndMotivation(score) {
      let grade, motivation, iconColor, iconSymbol, emoji;

      if (score >= 90) {
        grade = 'A';
        iconColor = 'bg-green-500';
        iconSymbol = 'üèÜ';
        emoji = 'üåü';
        motivation = 'Luar biasa! Anda menguasai materi turunan dengan sangat baik. Prestasi yang gemilang ini menunjukkan dedikasi dan kerja keras Anda. Terus pertahankan semangat belajar dan jangan pernah berhenti untuk mengeksplorasi matematika lebih dalam!';
      } else if (score >= 80) {
        grade = 'B+';
        iconColor = 'bg-blue-500';
        iconSymbol = '‚≠ê';
        emoji = 'üí™';
        motivation = 'Hebat! Anda sudah memahami konsep turunan dengan baik. Hasil ini menunjukkan bahwa Anda berada di jalur yang tepat. Dengan sedikit latihan tambahan, Anda pasti bisa mencapai level yang lebih tinggi. Tetap semangat!';
      } else if (score >= 70) {
        grade = 'B';
        iconColor = 'bg-indigo-500';
        iconSymbol = 'üëç';
        emoji = 'üìö';
        motivation = 'Bagus! Anda sudah memiliki pemahaman dasar yang solid tentang turunan. Ini adalah fondasi yang baik untuk terus berkembang. Perbanyak latihan soal dan jangan ragu untuk bertanya jika ada yang belum dipahami. Anda pasti bisa lebih baik!';
      } else if (score >= 60) {
        grade = 'C+';
        iconColor = 'bg-yellow-500';
        iconSymbol = 'üí°';
        emoji = 'üéØ';
        motivation = 'Cukup baik! Anda sudah menunjukkan usaha yang patut diapresiasi. Masih ada ruang untuk berkembang, dan itu adalah hal yang normal dalam proses belajar. Fokus pada konsep-konsep dasar dan jangan menyerah. Setiap langkah kecil adalah kemajuan!';
      } else if (score >= 50) {
        grade = 'C';
        iconColor = 'bg-orange-500';
        iconSymbol = 'üî•';
        emoji = 'üí™';
        motivation = 'Terus berjuang! Belajar matematika memang tidak mudah, tapi Anda sudah menunjukkan keberanian untuk mencoba. Jangan berkecil hati dengan hasil ini. Gunakan sebagai motivasi untuk belajar lebih giat. Ingat, setiap ahli matematika pernah memulai dari nol!';
      } else {
        grade = 'D';
        iconColor = 'bg-red-500';
        iconSymbol = 'üöÄ';
        emoji = 'üå±';
        motivation = 'Jangan menyerah! Setiap perjalanan belajar memiliki tantangannya masing-masing. Hasil ini bukan akhir dari segalanya, melainkan awal dari perjuangan yang lebih baik. Carilah bantuan dari guru atau teman, perbanyak latihan, dan percayalah bahwa Anda mampu berkembang!';
      }

      return { grade, motivation, iconColor, iconSymbol, emoji };
    }

    function showResults(score, correctAnswers, timeTaken) {
      document.getElementById('examScreen').classList.add('hidden');
      document.getElementById('resultsScreen').classList.remove('hidden');

      // Get grade and motivation
      const { grade, motivation, iconColor, iconSymbol, emoji } = getGradeAndMotivation(score);

      // Update basic results
      document.getElementById('finalScore').textContent = score;
      document.getElementById('correctCount').textContent = `${correctAnswers}/${currentQuestions.length}`;
      document.getElementById('timeTaken').textContent = timeTaken;
      document.getElementById('difficultyLevel').textContent = currentUser.difficulty.toUpperCase();

      // Update grade display
      document.getElementById('gradeDisplay').textContent = grade;
      document.getElementById('gradeDisplay').className = `text-4xl font-bold mb-2 ${score >= 90 ? 'text-green-600' :
        score >= 80 ? 'text-blue-600' :
          score >= 70 ? 'text-indigo-600' :
            score >= 60 ? 'text-yellow-600' :
              score >= 50 ? 'text-orange-600' : 'text-red-600'
        }`;

      // Update result icon
      const resultIcon = document.getElementById('resultIcon');
      resultIcon.className = `w-20 h-20 ${iconColor} rounded-full flex items-center justify-center mx-auto mb-4`;
      resultIcon.innerHTML = `<span class="text-white text-3xl">${iconSymbol}</span>`;

      // Update student identity
      document.getElementById('resultStudentName').textContent = currentUser.name;
      document.getElementById('resultStudentClass').textContent = currentUser.kelas;
      document.getElementById('resultUsername').textContent = currentUser.username;

      // Update date and time
      const now = new Date();
      const dateOptions = {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      };
      const timeOptions = {
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      };

      document.getElementById('examDate').textContent = now.toLocaleDateString('id-ID', dateOptions);
      document.getElementById('examTime').textContent = now.toLocaleTimeString('id-ID', timeOptions);

      // Update motivational comment
      const motivationElement = document.getElementById('motivationText');
      motivationElement.textContent = motivation;

      // Update motivation emoji
      const motivationComment = document.getElementById('motivationalComment');
      const emojiElement = motivationComment.querySelector('.text-2xl');
      emojiElement.textContent = emoji;

      // Update motivation box color based on grade
      motivationComment.className = `bg-gradient-to-r p-6 mb-6 rounded-r-lg border-l-4 ${score >= 90 ? 'from-green-50 to-emerald-50 border-green-500' :
        score >= 80 ? 'from-blue-50 to-cyan-50 border-blue-500' :
          score >= 70 ? 'from-indigo-50 to-purple-50 border-indigo-500' :
            score >= 60 ? 'from-yellow-50 to-amber-50 border-yellow-500' :
              score >= 50 ? 'from-orange-50 to-red-50 border-orange-500' : 'from-red-50 to-pink-50 border-red-500'
        }`;
    }

    // Restart functionality
    document.getElementById('restartBtn').addEventListener('click', function () {
      // Reset all variables
      currentUser = null;
      currentQuestions = [];
      currentQuestionIndex = 0;
      userAnswers = [];
      startTime = null;
      clearInterval(timerInterval);
      
      // Reset form
      document.getElementById('loginForm').reset();
      
      // Show login screen
      document.getElementById('resultsScreen').classList.add('hidden');
      document.getElementById('loginScreen').classList.remove('hidden');
    });

    function showMessage(message, type = 'info') {
      const messageDiv = document.createElement('div');
      messageDiv.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${type === 'error' ? 'bg-red-500 text-white' :
        type === 'warning' ? 'bg-yellow-500 text-white' :
          'bg-blue-500 text-white'
        }`;
      messageDiv.textContent = message;

      document.body.appendChild(messageDiv);

      setTimeout(() => {
        messageDiv.remove();
      }, 3000);
    }

    // Initialize app when page loads
    document.addEventListener('DOMContentLoaded', initializeApp);
  </script>

  <!-- 
 <script>(function () { function c() { var b = a.contentDocument || a.contentWindow.document; if (b) { var d = b.createElement('script'); d.innerHTML = "window.__CF$cv$params={r:'99ad2b9ae70cc211',t:'MTc2MjUyMjA3MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);"; b.getElementsByTagName('head')[0].appendChild(d) } } if (document.body) { var a = document.createElement('iframe'); a.height = 1; a.width = 1; a.style.position = 'absolute'; a.style.top = 0; a.style.left = 0; a.style.border = 'none'; a.style.visibility = 'hidden'; document.body.appendChild(a); if ('loading' !== document.readyState) c(); else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c); else { var e = document.onreadystatechange || function () { }; document.onreadystatechange = function (b) { e(b); 'loading' !== document.readyState && (document.onreadystatechange = e, c()) } } } })();</script>
 -->
</body>

</html>